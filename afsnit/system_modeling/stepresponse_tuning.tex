\documentclass[../../main]{subfiles}
\begin{document}

To tune the theoretical model the electromotive force, the motor torque and friction is adjusted, for both the top frame and the bottom frame, to fit the openloop step response of the physical system.
The system is tuned using the simulink models seen in figure \ref{fig:simulink_top} and figure
\ref{fig:simulink_bot}.


\begin{figure}[h]
        \centering
  			\fontsize{10}{12}\selectfont
				\def\svgwidth{1.3\textwidth}
  			\makebox[\textwidth][c]{
        	\includesvg[\main/afsnit/system_modeling/img/]{simulink_top}
				}
				\caption{Simulink top frame}
        \label{fig:simulink_top}
\end{figure}

\begin{figure}[h]
        \centering
				\def\svgwidth{1.3\textwidth}
  			\fontsize{10}{12}\selectfont
  			\makebox[\textwidth][c]{
        	\includesvg[\main/afsnit/system_modeling/img/]{simulink_bot}
				}
				\caption{Simulink bottom frame}
        \label{fig:simulink_bot}
\end{figure}

The adjusted motor constants can be viewed in table \ref{tab:fitted_motor_constants} and the resulting simulated step response interlaced with the physical step response can be seen in figure \ref{fig:validation_steptuning}.

\begin{table}[h]
	\centering
	\begin{tabular}{ll}
		\multicolumn{2}{c}{ \textbf{Top frame} }\\
		\hline
		Electromotive force& 0.1\si{ \frac{rad}{Vs}}\\
		Motor torque & 1.4 \si{ \frac{N m}{A}}\\
		Friction coefficient& 0.57\\

		\multicolumn{2}{c}{ \textbf{Bottom frame} }\\
		\hline
		Electromotive force& 3.5\si{ \frac{rad}{Vs}}\\
		Motor torque & 1.57 \si{ \frac{N m}{A}}\\
		Friction coefficient & 0.5\\
	\end{tabular}
	\caption{Adjusted motor constants.}
	\label{tab:fitted_motor_constants}
\end{table}

\begin{figure}[H]
        \centering
				\def\svgwidth{0.47\columnwidth}
				\subfloat[Step response of bottom frame with top frame at 0 degrees.]{%
				\includesvg[\main/afsnit/system_modeling/img/]{sim_validation_top}}
				\def\svgwidth{0.47\columnwidth}
				\subfloat[Step response of top frame, with start at 0 degrees.]{%
				\includesvg[\main/afsnit/system_modeling/img/]{sim_validation_bot}}
				\caption{Step response results of both frames.}
				\label{fig:validation_steptuning}
\end{figure}
It was not possible to tune the simulated model to fit the real data,
which indicates that there are some parameters not accounted for in the model.
It was not possible to match both the theoretical velocity and current to their practical counterparts at the same time. Since only position, and therefore velocity, is observable, it is prioritized to match the practical and theoretical velocity.
As the modeled system is not a perfect match, the requirement for the gain margin of the controller, to allow for disturbances, increases.
\end{document}
