\documentclass[../../main]{subfiles}
\begin{document}
The control engineering: \\
A mathematical model of the pan tilt system has been made. Based on this model a PI-controller with $K_p$ and $T_i$ gains have been tuned to comply with specifications as best as possible. 
A controller with the respective $K_p$ and $T_i$ have been implementet on the Tiva microcontroller. Stepresponses of the actual system have been logged and compared with the expected stepresponses from the mathematical model. The results a difference between the two. The stepresponses based on the mathematical model have no overshoot compared with the actual system, which has overshoot. Based on the results it is concluded that the mathematical model is not accurate enough, and that a PID-controller including a D-term will improve the response of the system by limiting overshoot.  

FreeRTOS:\\
A real operating system, FreeRTOS, has been implemented on the Tiva. FreeRTOS has been chosen as it can emulate tasks running in parallel on the micrcontroller. \\
The controller is implemented on the Tiva as a task with the highest possible priority to make sure it has the best timing possible for the system.
\\

Encoder:\\
The controller needs a position in order to calculate the PWM values for the pan-tilt system. For this purpose quadrature encoders, mounted on the motors, are used.
A quadrature decoder program has been designed and written for the FPGA to decode the encoders' signals into a position.
It can determine the position with a $\frac{1}{3}$ degrees precision and direction, in which the system is rotating. A velocity has been implmented, which uses the position to calculate the velocity.
\\

PWM:\\
The PWM signal's frequency has been calculated to be $1003$Hz, as this allows the motor to draw full current and utilize all available torque. \\

SPI:
The SPI protocol is a shift register protocol with a register size varying from 8 bits to a maximum of 16 bits. The protocol follows the master/slave princple, with the Tiva as the master and FPGA as slave. This protocol has been implemented on the FPGA by using a module created by x. 


\begin{itemize}
  \item PI controller choice
  \item control engineering:
  \begin{itemize}
    \item issue with nonlinaer modeling - how did we solve this?
    \item top and bottom frrame - two "individual" systems - are. theoretically fulfilling our requirements
    \item reality vs theoretical top and bottom frame - plus the finished handtuned values for Ki and Kp
  \end{itemize}
  \item design choices FPGA:
    \begin{itemize}
      \item Encoder - position counting with 1080 ticks or 1/3 degrees precision
      \item SPI - Protocol used
      \item PWM
      \item Homing?
    \end{itemize}
  \item embedded:
  \begin{itemize}
    \item Pi micrcontroller
    \item FreeRTOS
  \end{itemize}


\end{itemize}


\end{document}
